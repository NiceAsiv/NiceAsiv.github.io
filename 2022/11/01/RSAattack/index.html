<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>RSA 加密体制破译 - Asiv&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="RSA 加密体制破译 - Asiv&#39;s Blog" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://niceasiv.cn/2022/11/01/RSAattack/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2022-11-01T10:16:09.000Z" />
  
  <meta property="og:article:author" content="Asiv" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="3"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="3"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Asiv&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/essay">Essay</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/NiceAsiv" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/course/">course</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>November</span>
            <span>1,</span>
            <span>2022</span>
        </div>
        

        <h2 class="title">RSA 加密体制破译</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="题目摘要"><a href="#题目摘要" class="headerlink" title="题目摘要"></a>题目摘要</h2><h3 id="赛题名称：-RSA-加密体制破译"><a href="#赛题名称：-RSA-加密体制破译" class="headerlink" title="赛题名称： RSA 加密体制破译"></a>赛题名称： RSA 加密体制破译</h3><h3 id="赛题描述"><a href="#赛题描述" class="headerlink" title="赛题描述"></a>赛题描述</h3><p>RSA密码算法是使用最为广泛的公钥密码体制。该体制简单且易于实现，只需要选择5个参数即可（两个素数$𝑝$和$𝑞$、模数$𝑁&#x3D;𝑝𝑞$、加密指数$𝑒$和解密指数$𝑑$。设𝑚为待加密消息RSA体制破译相当于已知$𝑚^𝑒$ $mod$ $𝑁$能否还原𝑚的数论问题。目前模数规模为1024比特的RSA算法一般情况下是安全的，但是如果参数选取不当，同样存在被破译的可能。有人制作了一个RSA加解密软件采用的RSA体制的参数特点描述见密码背景部分）。</p>
<p>已知该软件发送某个明文的所有参数和加密过程的全部数据（加密案例文件详见附件3-1。Alice使用该软件发送了一个通关密语，且所有加密数据已经被截获，请问能否仅从加密数据恢复该通关密语及RSA体制参数？如能请给出原文和参数，如不能请给出已恢复部分并说明剩余部分不能恢复的理由？</p>
<h3 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h3><ol>
<li>原始明文</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This is a test of my RSA system.</span><br></pre></td></tr></table></figure>

<p>Frame0</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A5F51EB02EA9C0CC9B96926A08A761FE3E7CDB6E5B348DBEAEC761DBCFCDB15A6C76F8EE08196008AE60E396D7E228C6DAFC3CC1127F16EC87576B89C151F20F99098621FD46872BC92CDA8C915B758E5C0CACB994F55B8705B938126E08589E2502A7B9019C9A62E82392E8449E00CFC7DA17B8CDE92F9516CE9A2009F42DD900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100019726C82FED1E6CD58DE825528AE5634653C9921CAE02AFF7325F20D6E7085B7C8E3DC78D7518A78A8BC7D07E2E837083324579510851827794AE3D1FB9BAB360B1413A8F171A83804CEA73DFBC1248139BB27EB7D5BAD724AD8B08F51888B90562AF950725ACDD698F817AE62746CEA09479A191A6552B0116830355C68D0F61</span><br></pre></td></tr></table></figure>

<p>Frame1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A5F51EB02EA9C0CC9B96926A08A761FE3E7CDB6E5B348DBEAEC761DBCFCDB15A6C76F8EE08196008AE60E396D7E228C6DAFC3CC1127F16EC87576B89C151F20F99098621FD46872BC92CDA8C915B758E5C0CACB994F55B8705B938126E08589E2502A7B9019C9A62E82392E8449E00CFC7DA17B8CDE92F9516CE9A2009F42DD90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001789018FDB800AD59A54D27A77F280515BB3BFAB1CD75CB0A255A116D4A44849459FD887FF091F87C0B3E6305F019700E4E4CB3646D1DF276DFB87C4F64245F77377508EC6A796236F8ABB125023D3F4B898F55E3342D0A852193AF890990EA82F12FC85917BF132F2A58C449648D6E934B24E80307AB092DB18110D77BBA0F8E</span><br></pre></td></tr></table></figure>

<p>Frame2</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BA645145D9DE58B0FFA6FC4624A2815092D2A2DC405E7A2515F985727D3C52F479A4D04694568CA9B08391BE79BD122808CF6034AB7251088687BFF5916A4F4723FE1372DCF9B069CAB269A9F8F47CB50078D3279B9452C9B3B65A07B49C793783EDB8EB8D8F1A220D9EFED33147483103A2551A96932738255493F13B5119530000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001534810A0D1B2F6FB257DC3BBDA30AA76157B89038E52D05EE1E5DB06C2D79FAE84892950EF5FD8ADC4F241C3741AD7C97002902C8CA4D96574F28EDCEF3BEF15303335FA8D250102B4EE77E3B405E30F6B81E92403A8881285B65F29668E05B9CD6AC44FC1CD193CF4A5811A2649BE0EDEFBA91FA7143266286C5EC6EE8077D6</span><br></pre></td></tr></table></figure>

<p>Frame3</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BA645145D9DE58B0FFA6FC4624A2815092D2A2DC405E7A2515F985727D3C52F479A4D04694568CA9B08391BE79BD122808CF6034AB7251088687BFF5916A4F4723FE1372DCF9B069CAB269A9F8F47CB50078D3279B9452C9B3B65A07B49C793783EDB8EB8D8F1A220D9EFED33147483103A2551A96932738255493F13B51195300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100018805A937DABF25FE760F9F398C7D9D5955EF7468FEC89119F8DD69874FB009AB2C424BD6A8E85401C4CD130B48D0490586DFBD81C8154EDCEFC3AFC4F80338432197EB059AB54CF109B231416FB65E2F9BE4F01D455E25486D8E155A5874E8A910E8C65F73ACD953D316B35A148D5AC5834D86F66AD415EBA38AD3908B32780A</span><br></pre></td></tr></table></figure>

<p>2.过程及参数</p>
<p>  RSA 密码算法描述如下，包含体制参数选取和加解密过程。 </p>
<p>   1）RSA 体制参数选取 </p>
<p>​      Step1.每个使用者，任意选择两个大素数$𝑝$和$𝑞$，并求出其乘积$𝑁&#x3D;𝑝𝑞$。 </p>
<p>​      Step2.令$𝜑(𝑁)&#x3D;(𝑝−1)(𝑞−1)$选择整数$𝑒$，使得$GCD(𝑒,𝜑(𝑁))&#x3D;1$，并求出$𝑒$模 $𝜑(𝑁)$的逆元$𝑑$，即$𝑒𝑑≡1 mod (𝜑(𝑁))$ </p>
<p>​      Step3.将数对$(𝑒,𝑁)$公布为公钥，$𝑑$保存为私钥。 </p>
<p>   2）加解密过程</p>
<p>​      Bob欲传递明文𝑚给 Alice，则Bob首先由公开途径找出 Alice 的公钥 $(𝑒,𝑁)$，Bob 计算加密的信息$𝑐$为:$𝑐 ≡ 𝑚^𝑒$ $mod$ $𝑁$。</p>
<p>​      Bob 将密文$𝑐$传送给 Alice。 随后 Alice 利用自己的私钥$𝑑$解密：<br>​      $𝑐^e ≡ (𝑚^𝑒)^𝑑 ≡ 𝑚^{𝑒𝑑}≡ 𝑚\space mod\space 𝑁$  </p>
<p>   Alice 使用的 RSA 密码体制有以下事项需要说明： </p>
<p>​	1）模数𝑁&#x3D;𝑝𝑞规模为<strong>1024比特</strong>，其中𝑝，𝑞为素数； </p>
<p>​	2）素数𝑝由某一随机数发生器生成；</p>
<p>​	3）素数𝑞可以随机选择，也可以由2）中的随机数发生器产生； </p>
<p>​	4）可以对文本加密，每次加密<strong>最多8个明文字符</strong>； </p>
<p>​	5）明文超过8个字符时，对明文分片，<strong>每个分片不超过8个字符</strong>； </p>
<p>​	6）分片&#x3D;&#x3D;明文填充为512比特消息后再进行加密，填充规则为高位添加64比特标志位，随后加上32比特通信序号&#x3D;&#x3D;，再添加若干个0，最后64比特为明文分片字符对应的ASCII码（**注：填充方式参见加密案例，但注意每次通信的标志位可能变化） </p>
<p>​	7）分片加密后发送一个加密帧数据，帧数据文件名称为FrameXX，其中XX表示接收序号，该序号不一定等于通信序号； </p>
<p>​	8）帧数据的数据格式如下，其中数据都是16进制表示，结构如下&#x3D;&#x3D;<strong>1024bit模数N | 1024bit加密指数e | 1024bit密文</strong>&#x3D;&#x3D; $m^e\space mod \space N$。 </p>
<p>​	9）由于Alice初次使用该软件，可能会<strong>重复发送</strong>某一明文分片。</p>
<p><strong>符号说明：</strong> n 模数、p 素数、q素数、e加密指数、d 解密指数、m 明文分片、c 密文分片、“0X”十六进制数据表示</p>
<p><strong>明文：</strong> “This is a test of my RSA system.”将其分割为4个8字符长度消息(注意：空格也是一个字符)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This <span class="keyword">is</span> 	该<span class="number">8</span>字符对应的ASCII为		<span class="number">54</span>	<span class="number">68</span>	<span class="number">69</span>	<span class="number">73</span>	<span class="number">20</span>	<span class="number">69</span>	<span class="number">73</span>	<span class="number">20</span>	将其视为<span class="number">64</span>比特整数为==&gt;	<span class="number">0X5468697320697320</span></span><br><span class="line">a test o	该<span class="number">8</span>字符对应的ASCII为		<span class="number">61</span>	<span class="number">20</span>	<span class="number">74</span>	<span class="number">65</span>	<span class="number">73</span>	<span class="number">74</span>	<span class="number">20</span>	6F	将其视为<span class="number">64</span>比特整数为==&gt;	<span class="number">0X612074657374206F</span></span><br><span class="line">f my RSA	该<span class="number">8</span>字符对应的ASCII为		<span class="number">66</span>	<span class="number">20</span>	6D	<span class="number">79</span>	<span class="number">20</span>	<span class="number">52</span>	<span class="number">53</span>	<span class="number">41</span>	将其视为<span class="number">64</span>比特整数为==&gt;	<span class="number">0X66206D7920525341</span></span><br><span class="line"> system.	该<span class="number">8</span>字符对应的ASCII为		<span class="number">20</span>	<span class="number">73</span>	<span class="number">79</span>	<span class="number">73</span>	<span class="number">74</span>	<span class="number">65</span>	6D	2E	将其视为<span class="number">64</span>比特整数为==&gt;	<span class="number">0X2073797374656D2E</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>选择前缀为0xFFFFFFFFFFFFFFFF,再添加通信序号和若干个0，最终填充后的4条消息依次为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xFFFFFFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005468697320697320</span></span><br><span class="line"><span class="number">0xFFFFFFFFFFFFFFFF000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612074657374206F</span></span><br><span class="line"><span class="number">0xFFFFFFFFFFFFFFFF00000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066206D7920525341</span></span><br><span class="line"><span class="number">0xFFFFFFFFFFFFFFFF0000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000002073797374656D2E</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第0个明文分片参数及加密结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">0XC60C5F1B997ED8A5E340023F33D2E269CFB423A3CF66B46D3F686747403A92B1265CB12B9A4E0135B890254F31A2C3F96A0427B39A36DEFDEEB85C57A80A9641</span></span><br><span class="line">q= <span class="number">0XD684DA331AB6157DA338B6D7B08AB4C1B72C29BB7F9EF445466056DFDBF29809C4D4A2435986A40DE688AFE7CC5A5C519F7C63CB486E44D523B0E1EF21C22199</span></span><br><span class="line">n= <span class="number">0XA5F51EB02EA9C0CC9B96926A08A761FE3E7CDB6E5B348DBEAEC761DBCFCDB15A6C76F8EE08196008AE60E396D7E228C6DAFC3CC1127F16EC87576B89C151F20F99098621FD46872BC92CDA8C915B758E5C0CACB994F55B8705B938126E08589E2502A7B9019C9A62E82392E8449E00CFC7DA17B8CDE92F9516CE9A2009F42DD9</span></span><br><span class="line">e= <span class="number">0X10001</span></span><br><span class="line">d= <span class="number">0X4C5340AAECBB1BB5BE74F09F9D9D45BF4583ECF38334D75FF44834A4809CEC4D57071C9374DC1EC3BF574634B0D30DC7EF1D04E0131EAA2F5C4B8364D6A95676C23F9DADAAB4523A6F5B22EC5904650BF558B3FDF39E3B13EA4771FB1D297DA03C8E1E82F4759B31A9492C56E4D1C690A66ECEC430849A17C027D1A7480F1E01</span></span><br><span class="line">m= <span class="number">0XFFFFFFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005468697320697320</span></span><br><span class="line">c= <span class="number">0X9726C82FED1E6CD58DE825528AE5634653C9921CAE02AFF7325F20D6E7085B7C8E3DC78D7518A78A8BC7D07E2E837083324579510851827794AE3D1FB9BAB360B1413A8F171A83804CEA73DFBC1248139BB27EB7D5BAD724AD8B08F51888B90562AF950725ACDD698F817AE62746CEA09479A191A6552B0116830355C68D0F61</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第1个明文分片参数及加密结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">0XC60C5F1B997ED8A5E340023F33D2E269CFB423A3CF66B46D3F686747403A92B1265CB12B9A4E0135B890254F31A2C3F96A0427B39A36DEFDEEB85C57A80A9641</span></span><br><span class="line">q= <span class="number">0XD684DA331AB6157DA338B6D7B08AB4C1B72C29BB7F9EF445466056DFDBF29809C4D4A2435986A40DE688AFE7CC5A5C519F7C63CB486E44D523B0E1EF21C22199</span></span><br><span class="line">n= <span class="number">0XA5F51EB02EA9C0CC9B96926A08A761FE3E7CDB6E5B348DBEAEC761DBCFCDB15A6C76F8EE08196008AE60E396D7E228C6DAFC3CC1127F16EC87576B89C151F20F99098621FD46872BC92CDA8C915B758E5C0CACB994F55B8705B938126E08589E2502A7B9019C9A62E82392E8449E00CFC7DA17B8CDE92F9516CE9A2009F42DD9</span></span><br><span class="line">e= <span class="number">0X10001</span></span><br><span class="line">d= <span class="number">0X4C5340AAECBB1BB5BE74F09F9D9D45BF4583ECF38334D75FF44834A4809CEC4D57071C9374DC1EC3BF574634B0D30DC7EF1D04E0131EAA2F5C4B8364D6A95676C23F9DADAAB4523A6F5B22EC5904650BF558B3FDF39E3B13EA4771FB1D297DA03C8E1E82F4759B31A9492C56E4D1C690A66ECEC430849A17C027D1A7480F1E01</span></span><br><span class="line">m= <span class="number">0XFFFFFFFFFFFFFFFF000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612074657374206F</span></span><br><span class="line">c= <span class="number">0X789018FDB800AD59A54D27A77F280515BB3BFAB1CD75CB0A255A116D4A44849459FD887FF091F87C0B3E6305F019700E4E4CB3646D1DF276DFB87C4F64245F77377508EC6A796236F8ABB125023D3F4B898F55E3342D0A852193AF890990EA82F12FC85917BF132F2A58C449648D6E934B24E80307AB092DB18110D77BBA0F8E</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第2个明文分片参数及加密结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">0XD502B3D96C648A9393966CDD37188D37576AA221290C861B347ED7A57640993F7ED2D16992B42AA3CA66936D3268DE47EB3A61B1495C982BF54EC0350B907C4F3CA272F9ED04EEB355367DFDA1B89357130A25411DAC4E3B8A1EECC594E0435F0E7298897B54D6C334062C8D8508AC67CEDAECD1A5FCA84BF2EE5D</span></span><br><span class="line">q= <span class="number">0XE00258CB6F</span></span><br><span class="line">n= <span class="number">0XBA645145D9DE58B0FFA6FC4624A2815092D2A2DC405E7A2515F985727D3C52F479A4D04694568CA9B08391BE79BD122808CF6034AB7251088687BFF5916A4F4723FE1372DCF9B069CAB269A9F8F47CB50078D3279B9452C9B3B65A07B49C793783EDB8EB8D8F1A220D9EFED33147483103A2551A96932738255493F13B511953</span></span><br><span class="line">e= <span class="number">0X10001</span></span><br><span class="line">d= <span class="number">0X524EB244F1CE59966C273B91AC40B620CFB55BA2030E871F01147E11844888B6224C5D4DE14551DFDB93C984DAD94A4359643B247ED6CC7DE774A15440D525E26FE9CF4328DBEF2AAA8E402922596F1C23B8F117C018870777434C93B68F1028295DFA6E69FA8E00FFC4EFEF747C348EDBC99C529B7C3B649813647FF90A8261</span></span><br><span class="line">m= <span class="number">0XFFFFFFFFFFFFFFFF00000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066206D7920525341</span></span><br><span class="line">c= <span class="number">0X534810A0D1B2F6FB257DC3BBDA30AA76157B89038E52D05EE1E5DB06C2D79FAE84892950EF5FD8ADC4F241C3741AD7C97002902C8CA4D96574F28EDCEF3BEF15303335FA8D250102B4EE77E3B405E30F6B81E92403A8881285B65F29668E05B9CD6AC44FC1CD193CF4A5811A2649BE0EDEFBA91FA7143266286C5EC6EE8077D6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第3个明文分片参数及加密结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">0XD502B3D96C648A9393966CDD37188D37576AA221290C861B347ED7A57640993F7ED2D16992B42AA3CA66936D3268DE47EB3A61B1495C982BF54EC0350B907C4F3CA272F9ED04EEB355367DFDA1B89357130A25411DAC4E3B8A1EECC594E0435F0E7298897B54D6C334062C8D8508AC67CEDAECD1A5FCA84BF2EE5D</span></span><br><span class="line">q= <span class="number">0XE00258CB6F</span></span><br><span class="line">n= <span class="number">0XBA645145D9DE58B0FFA6FC4624A2815092D2A2DC405E7A2515F985727D3C52F479A4D04694568CA9B08391BE79BD122808CF6034AB7251088687BFF5916A4F4723FE1372DCF9B069CAB269A9F8F47CB50078D3279B9452C9B3B65A07B49C793783EDB8EB8D8F1A220D9EFED33147483103A2551A96932738255493F13B511953</span></span><br><span class="line">e= <span class="number">0X10001</span></span><br><span class="line">d= <span class="number">0X524EB244F1CE59966C273B91AC40B620CFB55BA2030E871F01147E11844888B6224C5D4DE14551DFDB93C984DAD94A4359643B247ED6CC7DE774A15440D525E26FE9CF4328DBEF2AAA8E402922596F1C23B8F117C018870777434C93B68F1028295DFA6E69FA8E00FFC4EFEF747C348EDBC99C529B7C3B649813647FF90A8261</span></span><br><span class="line">m= <span class="number">0XFFFFFFFFFFFFFFFF0000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000002073797374656D2E</span></span><br><span class="line">c= <span class="number">0X8805A937DABF25FE760F9F398C7D9D5955EF7468FEC89119F8DD69874FB009AB2C424BD6A8E85401C4CD130B48D0490586DFBD81C8154EDCEFC3AFC4F80338432197EB059AB54CF109B231416FB65E2F9BE4F01D455E25486D8E155A5874E8A910E8C65F73ACD953D316B35A148D5AC5834D86F66AD415EBA38AD3908B32780A</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="密文结构解析"><a href="#密文结构解析" class="headerlink" title="密文结构解析"></a>密文结构解析</h2><p>提取传送帧的信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">n=[]<span class="comment">#模数集合</span></span><br><span class="line">e=[]<span class="comment">#公钥指数集合</span></span><br><span class="line">c=[]<span class="comment">#密文集合</span></span><br><span class="line">m=&#123;&#125;<span class="comment">#明文集合</span></span><br><span class="line"><span class="comment"># Path: code\main.py</span></span><br><span class="line">sloved=[]<span class="comment">#已解密的密文集合</span></span><br><span class="line">filename=[<span class="string">&#x27;RSA\data\Frame&#x27;</span>+<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>)]<span class="comment">#文件名集合</span></span><br><span class="line"><span class="comment"># print(filename)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        f=<span class="built_in">open</span>(filename[i],<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        data=f.read()</span><br><span class="line">        <span class="comment">#str-&gt;hex-&gt;int</span></span><br><span class="line">        n.append(<span class="built_in">int</span>(data[:<span class="number">256</span>],<span class="number">16</span>))</span><br><span class="line">        e.append(<span class="built_in">int</span>(data[<span class="number">256</span>:<span class="number">512</span>],<span class="number">16</span>))</span><br><span class="line">        c.append(<span class="built_in">int</span>(data[<span class="number">512</span>:],<span class="number">16</span>))</span><br><span class="line"><span class="comment">#输出e的值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]=&#x27;</span>+<span class="built_in">str</span>(e[i]))</span><br><span class="line"><span class="comment">#输出n的值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]=&#x27;</span>+<span class="built_in">str</span>(n[i]))</span><br><span class="line"><span class="comment">#输出c的</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]=&#x27;</span>+<span class="built_in">str</span>(c[i]))</span><br></pre></td></tr></table></figure>

<p>Output</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">e[0]=46786465362686334917265996843779843233606992585424976481745055335468678697948774988450305612127967926533923268260412557000125153569622340353246096040604284883505587337829322949633637609180797447754513992039018904786537115087888005528547900640339270052628915440787357271345416818313808448127098885767015748889</span><br><span class="line">e[1]=65537</span><br><span class="line">e[2]=65537</span><br><span class="line">e[3]=5</span><br><span class="line">e[4]=152206992575706893484835984472544529509325440944131662631741403414037956695665533186650071476146389737020554215956181827422540843366433981607643940546405002217220286072880967331118344806315756304650248634546597784597963886656422706197757265316981889118026978865295597135470735576032282694348773714479076093197</span><br><span class="line">e[5]=65537</span><br><span class="line">e[6]=65537</span><br><span class="line">e[7]=3</span><br><span class="line">e[8]=5</span><br><span class="line">e[9]=65537</span><br><span class="line">e[10]=65537</span><br><span class="line">e[11]=3</span><br><span class="line">e[12]=5</span><br><span class="line">e[13]=65537</span><br><span class="line">e[14]=65537</span><br><span class="line">e[15]=3</span><br><span class="line">e[16]=5</span><br><span class="line">e[17]=65537</span><br><span class="line">e[18]=65537</span><br><span class="line">e[19]=65537</span><br><span class="line">e[20]=5</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">n[0]=90058705186558569935261948496132914380077312570281980020033760044382510933070450931241348678652103772768114420567119848142360867111065753301402088676701668212035175754850951897103338079978959810673297215370534716084813732883918187890434411552463739669878295417744080700424913250020348487161014643951785502867</span><br><span class="line">n[1]=92921790800705826977497755832938592891062287903332844896046168726101016067456726822505517352409138948392871113192427210529297191908638888388136391240683157994654207338463678065440899870434887094216772312358731142317774259942199808535233769089985063860828267808621928898445383706310204223006136919334252875849</span><br><span class="line">n[2]=90252653600964453524559669296618135272911289775949194922543520872164147768650421038176330053599968601135821750672685664360786595430028684419411893316074286312793730822963564220564616708573764764386830123818197183233443472506106828919670406785228124876225200632055727680225997407097843708009916059133498338129</span><br><span class="line">n[3]=92270627783020341903769877272635163757611737252302329401876135487358785338853904185572496782685853218459404423868889360808646192858060332110830962463986164014331540336037718684606223893506327126112739408023014900003600028654929488487584130630596342720833061628867179840913592694993869009133576053124769728363</span><br><span class="line">n[4]=90058705186558569935261948496132914380077312570281980020033760044382510933070450931241348678652103772768114420567119848142360867111065753301402088676701668212035175754850951897103338079978959810673297215370534716084813732883918187890434411552463739669878295417744080700424913250020348487161014643951785502867</span><br><span class="line">n[5]=99193711547257063160816850544214924340574358752670644615293764532335872088470223740970673347993652626497557387222167784182876395436088845281840169701654629849214222297784511349059698963212947299142320497759258889425182705042123217476724761095690092179821753840224757786599021225709340258545979566824267620959</span><br><span class="line">n[6]=146839643970016464813197409569004275595828791825722617066607993001682901023784267554815946189374651530288894322286859792246413142980277245909181062525398546369553995023529451396820549308690493928593324007689135648753323161394735120908960458860801743476353228970081369439513197105039143930008573928693059198131</span><br><span class="line">n[7]=155266493936043103849855199987896813716831986416707080645036022909153373110367007140301635144950634879983289720164117794783088845393686109145443728632527874768524615377182297125716276153800765906014206797548230661764274997562670900115383324605843933035314110752560290540848152237316752573471110899212429555149</span><br><span class="line">n[8]=102900163930497791064402577447949741195464555746599233552338455905339363524435647082637326033518083289523250670463907211548409422234391456982344516192210687545692054217151133151915216123275005464229534891629568864361154658107093228352829098251468904800809585061088484485542019575848774643260318502441084765867</span><br><span class="line">n[9]=97767951046154372321400443371234495476461828137251939025051233003462769415459435471728054384852461870179980010660162922547425212869925648424741526671585598167502856111641944825179295197098826911226483155821197251989297102189187139234080795582529077092266799813985026581245196104843272305656744384140745492897</span><br><span class="line">n[10]=93836514358344173762895084384953633159699750987954044414830106276642828025218933012478990865656107605541657809389659063108620208004740646099662700112782252200834393363574089818787717951026690934986964275526538236750596344542450864284576226592039259070002692883820960186403938410354082341916474419847211138467</span><br><span class="line">n[11]=112306066601652819062206435724795595603085908011001671184332227488970057128128821831260649058569739569103298091727188365019228385820143813415009397359257831092635374404034997011441653286642458431865026213129412677064308342580757248577955071384972714557250468686599901682728173096745710849318629959223270431039</span><br><span class="line">n[12]=90267480939368160749458049207367083180407266027531212674879245323647502822038591438536367206422215464489854541063867946215243190345476874546091188408120551902573113507876754578290674792643018845798263156849027209440979746485414654160320058352559498237296080490768064578067282805498131582552189186085941328701</span><br><span class="line">n[13]=94390533992358895550704225180484604016029781604622607833044135524814562613596803297695605669157378162035217814540004231075201420796787547733762265959320018107419058832819010681344133011777479722382525797938558181629835768471461434560813554411133962651212455645589624432040989600687436833459731886703583047283</span><br><span class="line">n[14]=120008876536855131221255979370745233738591934188224528487535120483456214085493237482915446419599357910343450285858995374277365393767669569942204888383426461862651659865189178784473131914234181752055950431093341514138390898892413182538823693941124637301582389014479754627419560568004831093116617428970538503551</span><br><span class="line">n[15]=147733349387696521015664992396355145811249793103958464053225389476050097503928022819269482555955365534137156079172704297584033078453033637103720972881068435459202133846880715879894340131656691631756162323422868846616160423755883726450486845175227682329583615739797782025647376042249605775433971714513081755709</span><br><span class="line">n[16]=90673177193017332602781813187879442725562909473411994052511479411887936365983777106776080722300002656952655125041151156684340743907349108729774157616323863062525593382279143395837261053976652138764279456528493914961780300269591722101449703932139132398288208673556967030162666354552157189525415838326249712949</span><br><span class="line">n[17]=111178307033150739104608647474199786251516913698936331430121060587893564405482896814045419370401816305592149685291034839621072343496556225594365571727260237484885924615887468053644519779081871778996851601207571981072261232384577126377714005550318990486619636734701266032569413421915520143377137845245405768733</span><br><span class="line">n[18]=93394639108667212482180458616036741615058981058942739509025631675767304945732437421192075466824789572910657586684470553691049259504106442090140927782673066834126848556317079995332229262871079799089771973100731889841015960713908117908583988637159206246729697336281050046919985463146705713899703248595045701819</span><br><span class="line">n[19]=94154993593274109828418786834159728190797445711539243887409583756844882924221269576486611543668906670821879426307992404721925623741478677756083992902711765865503466687919799394258306574702184666207180530598057989884729154273423032471322027993848437082723045300784582836897839491321003685598931080456249945287</span><br><span class="line">n[20]=90916739755838083837461026375700330885001446224187511395518230504776419813625940046511904838818660297497622072999229706061698225191645268591198600955240116302461331913178712722096591257619538927050886521512453691902946234986556913039431677697816965623861908091178749411071673467596883926097177996147858865293</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">c[0]=48641173720475702278690317652676924796340996697567087705119344461991930773386153198223372579328462635803653561516674380209276666328375805315553713680858906705068657158073776194628700821011001144559278784795978097710145192236347629751116534400207288736776545247409895672030976932673010818369814246455196991083</span><br><span class="line">c[1]=1626661141529320283833484152716550848856697186049377493478368799832043379420727509223318694347625977694500761460048670101820769656612419734057871562023463159698522348510157125720014700549254630959391701883372400982386084212421115166791728704867253734354874934210987301137512341070190760227227749365878233484</span><br><span class="line">c[2]=39632263504870478574861695051251850807454294787974709214866410237055871793939895562441267574482198916367858789237648434983815369123479208726344716594227785308836601932181727610859898951190206345056426253251079929822424252271957269630987623886812686545521745791771387808772030614435314730783528512800343192265</span><br><span class="line">c[3]=83421434286602546493364204139182949897795123160498680670964040331447569764445309937195566103281638928183742488663157138572020817924561990979723444797045375101801354862472761507421896454904818874439231990567738173059815647539737800523632262742398190575822391771655932895657208471832891505814792263361394479317</span><br><span class="line">c[4]=19560634556305755550927540610989537766715902244072312818350844104485773927537226443429404190213856361759564153804627450805880512600339869169513348929194643809859468549718922965997647689203029517135396008631050292544022651948009392475583045438153697076529266662217519588521116539517972522591294232192817502376</span><br><span class="line">c[5]=26054677793581772924866273737009673285775062802734786532404396138990264566536537921648515854012553861999940229349708989519156563830916553754762208466745321226835312974971739761769324569315525872096987367001543758380071859429619580182411498650200401467760546057912183435480924905200466941116258838789328064564</span><br><span class="line">c[6]=47190775807472506173587993082023759909601357229808667044044468676457696140445235738005020994278091230440755033222450219378047807646817722376918364211727971804312327204294555178996480944188624972632371674822397258127227029990196956900925820980263353418653201918881814896866168764140848945600419602253279143149</span><br><span class="line">c[7]=124929943232081828105808318993257526364596580021564021377503915670544445679836588765369503919311404328043203272693851622132258819278328852726005776082575583793735570095307898828254568015886630010269615546857335790791577865565021730890364239443651479580968112031521485174068731577348690810906553798608040451024</span><br><span class="line">c[8]=25585088950095290712328215701309273521406235982885781641137768116285362079062975527364909549362511146004390419156826709543326814581466248280564194951706937822088902607754944405407698735824315900942915322054614437632116732271787823814807624841386886185122143173564380877370643120953803688563589496390425159539</span><br><span class="line">c[9]=14375950543873882011796759348848479283522955796749853113492047625299699702886303193822347995567175524401038661237990847185236138967814088030767785916645492142741397786256445305366822277551514353423864240674522264407918605662008550545442780563568811883349771003546081844527788515420708612431091464410712019656</span><br><span class="line">c[10]=78852785408127338210375705302361611580033298047358566712385067002412358292419274287993295604646693755514055710305938805847184012173449160624823261013152092151242661538772012880714981492275731658527465442787266554947828301571586721387286510359738598116104180351027973922256460236377354127082438812404967605644</span><br><span class="line">c[11]=108387832390337770947361518376552702503741092284778824448943971792044922720461955035726863109418657218498659460663504872870862538725835055240750735576735249122665348803252691221869146679004017916359067454693701495389784159620341860394035373599823801288442604273046729873467936004227013186659110262247417571857</span><br><span class="line">c[12]=44374979291120575503988741531987454898919254880086464254904878064332010355432423956182135846738023874326776872139229379943321321362822522900479438294291206287205647145759972233097276253408812699557305314344220807356024994977399840843758750494467535572805794732065369887057841293267499209427585419962565568495</span><br><span class="line">c[13]=41663689952657185984513733558388033289292857758748468070934326941659317694408873831451567385012905508903797893149006067280788298408959017459890579859784072677410890657854942639040056924596925599973762214900728648657052474974405878868755028761443878403349272421153452240103741921751653022646614028009138548572</span><br><span class="line">c[14]=35133765260146855599194761500993159592311136378033858818728078464540389548474611501950689942825550399101504201020687961256642455745888410410524955937773951578993882275525944145131794970001708655718844507774877602125183877782393564092461821246419013099835940432551540513624090850765797735157630551978900512155</span><br><span class="line">c[15]=52253817590056116368273294519761274350847193477090280916373828903718796358618956145225746496960677477661151583828604021049936963779103440560630451125137344639503705880024677345063113240530798352727432768980751992926293801206779839157443722614687126711272753610923903360818026083573711899014859313677159790039</span><br><span class="line">c[16]=24086371701602948122317790211004032014326487279907486724991846810668564197542368948703436295770758262739732290677177527297040556666434577730354732397784651220918412407485171180732327730242552955646750279842251200227937257322414662213662054605527282812231172173474061845763736546747711105935349033514358348526</span><br><span class="line">c[17]=1395222187334055833498435136007269572138525113145744882969531037442244086277594803865217301719947066153176244638660864035949705664670633245110847416168796640199238733478540080417312141011028469385167826450855601412915611725028631975605932279023918771764204031806414734015476034106891049334159757621016327648</span><br><span class="line">c[18]=49047978458885807127192385282227726754593888749388775377492411121925201201621099927332087316607446894372751446254341808051569111053293066232980434901592875347200122022210780536817524813076908750647137301610117592355818408280291766068780616226847056325075159440352473034526412778650516438709293396458312728764</span><br><span class="line">c[19]=52958695992371180409414011678115981405835026800648278393085136639708219930134280877954018305615378579281651249142230848262822421713895227069561145945972448893229231020632492517869034217943260664130647322694583182800800838539691542175229797652856708373533581250607375664993806654537737027000328299623032632769</span><br><span class="line">c[20]=23204039098754030513954332212496652705175644349879686639449689791620605370809827884267260830136516742466455588549253481016504796674014871020503543639681251834114159250986728840380777774144853925216884802529230212783759821262799845229436535491711201551797166082529740271577684082458494926929260818927584104158</span><br></pre></td></tr></table></figure>

<h3 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h3><ul>
<li><p>遍历所有的模数N，判断是否存在模数相同的加密片段，如果猜测可以用共模攻击</p>
</li>
<li><p>遍历寻找任意两个模数N的公因子，如果得到不为1的公因子则可以因数碰撞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#遍历所有模数,找到模数相同的加密密文</span></span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;n[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]==&#x27;</span>+<span class="string">&#x27;n[&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历寻找任意两个模数N的公因子，如果得到不为1的公因子则可以成功分解这两个模数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">            <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rem=math.gcd(n[i],n[j])</span><br><span class="line">                <span class="keyword">if</span> rem!=<span class="number">1</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;gcd(n[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;],n[&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;]&gt;1&#x27;</span>)</span><br><span class="line">                        </span><br><span class="line">结果                        </span><br><span class="line"><span class="comment">#n[0]==n[4]</span></span><br><span class="line"><span class="comment">#gcd(n[1],n[18])&gt;1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历所有加密指数e，寻找低加密指数及对应的加密对，可以用低指数广播攻击</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">e[0]=46786465362686334917265996843779843233606992585424976481745055335468678697948774988450305612127967926533923268260412557000125153569622340353246096040604284883505587337829322949633637609180797447754513992039018904786537115087888005528547900640339270052628915440787357271345416818313808448127098885767015748889</span><br><span class="line">e[1]=e[2]=e[5]=e[6]=e[9]=e[10]=e[13]=e[14]=e[17]=e[18]=e[19]=65537</span><br><span class="line">e[2]=65537</span><br><span class="line">e[3]=e[8]=e[12]=e[16]=e[20]=5</span><br><span class="line">e[4]=152206992575706893484835984472544529509325440944131662631741403414037956695665533186650071476146389737020554215956181827422540843366433981607643940546405002217220286072880967331118344806315756304650248634546597784597963886656422706197757265316981889118026978865295597135470735576032282694348773714479076093197</span><br><span class="line">e[7]=e[11]=e[15]=3</span><br></pre></td></tr></table></figure>

<p>对上述的公钥e进行分析,主要有以下几种，其中e比较小的有3和5，其中</p>
<p>  Frame7，Frame11，Frame15采用低加密指数<code>e=3</code>进行加密</p>
<p>  Frame3，Frame8，Frame12，Frame16和Frame20均采用低加密指数<code>e=5</code>进行加密</p>
</li>
<li><p>采用费马分解尝试p,q差距比较小的帧和Pollard p-1分解进行尝试p,q差距比较大的帧</p>
<blockquote>
<p>Frame10可以用费马分解法破解</p>
<p>Frame2，6，19可以用p-1分解法破解</p>
</blockquote>
</li>
<li><p>Baidu or Google Hack</p>
</li>
</ul>
<h2 id="实例破解"><a href="#实例破解" class="headerlink" title="实例破解"></a>实例破解</h2><h3 id="公共模数攻击"><a href="#公共模数攻击" class="headerlink" title="公共模数攻击"></a>公共模数攻击</h3><p>n[0]&#x3D;&#x3D;n[4],还因为可能存在重复发包</p>
<p>设两个用户的公钥分别为 $e_1$ 和 $e_2$ ，且两者互质。明文消息为 $m$ ，密文分别为:<br>$$<br>\begin{aligned}<br>&amp;c_1&#x3D;m^{e_1} \bmod n \<br>&amp;c_2&#x3D;m^{e_2} \bmod n<br>\end{aligned}<br>$$<br>当攻击者截获 $c_1$ 和 $c_2$ 后，就可以恢复出明文。用扩展欧几里得算法求出 $r e_1+s e_2&#x3D;1 \bmod n$ 的两个整数 $r$ 和 $s$ ，由此可得:<br>$$<br>\begin{aligned}<br>c_1^r c_2^s &amp; \equiv m^{r e_1} m^{s e_2} \bmod n \<br>&amp; \equiv m^{\left(r e_1+s e_2\right)} \bmod n \<br>&amp; \equiv m \bmod n<br>\end{aligned}<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#公共模数攻击</span></span><br><span class="line"><span class="comment">#扩展欧几里得算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a,b</span>):</span><br><span class="line">        <span class="keyword">if</span> b==<span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                x,y,r=exgcd(b,a%b)</span><br><span class="line">                x,y=y,(x-(a//b)*y)</span><br><span class="line">                <span class="keyword">return</span> x,y,r</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">same_mod_attack</span>(<span class="params">n,e1,e2,c1,c2</span>):</span><br><span class="line">    x,y,r=exgcd(e1,e2)</span><br><span class="line">    <span class="comment">#求模逆元</span></span><br><span class="line">    <span class="keyword">if</span> x&lt;<span class="number">0</span>:</span><br><span class="line">        x=-x;</span><br><span class="line">        c1=gmpy2.invert(c1,n)</span><br><span class="line">    <span class="keyword">elif</span> y&lt;<span class="number">0</span>:</span><br><span class="line">        y=-y;</span><br><span class="line">        c2=gmpy2.invert(c2,n) </span><br><span class="line">    <span class="comment">#求解明文</span></span><br><span class="line">    m=<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n</span><br><span class="line">    <span class="comment">#将明文转换为hex</span></span><br><span class="line">    m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">    <span class="comment">#将hex转换为str</span></span><br><span class="line">    m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment">#公共模数攻击</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">            <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">                m2=same_mod_attack(n[i],e[i],e[j],c[i],c[j])</span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m2</span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(j)]=m2</span><br><span class="line">     <span class="built_in">print</span>(sloved)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>{‘Frame0’: b’My secre’, ‘Frame4’: b’My secre’}</p>
</blockquote>
<h3 id="公因数碰撞攻击"><a href="#公因数碰撞攻击" class="headerlink" title="公因数碰撞攻击"></a>公因数碰撞攻击</h3><p>Frame1、Frame18采用该种攻击方法</p>
<p>因数碰撞法指的是, 如果参数选取不当, $p$ 或者 $q$ 在多个RSA加密中出现多次，那么生成不同的 $\mathrm{n}$ 可能会有相同的因子，我们假设 $\mathrm{p}$相同,$\mathrm{q}$不同，那么在<br>$$<br>\left{\begin{array}{l}<br>n_1&#x3D;p * q_1 \<br>n_2&#x3D;p * q_2<br>\end{array}\right.<br>$$<br>很容易知道<br>$$<br>\operatorname{gcd}\left(n_1, n_2\right)&#x3D;p<br>$$<br>这样很快就能将他们各自的私钥求解出来了。<br>代码过于简单, 直接<code>gcd</code>两个因数就行, 结果不为1就说明有相同因数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#公因数碰撞攻击</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">same_factor_attack</span>():</span><br><span class="line">        p_of_prime=gmpy2.gcd(n[<span class="number">1</span>],n[<span class="number">18</span>])</span><br><span class="line">        q1=n[<span class="number">1</span>]//p_of_prime</span><br><span class="line">        q18=n[<span class="number">18</span>]//p_of_prime</span><br><span class="line">        phi1=(p_of_prime-<span class="number">1</span>)*(q1-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">        phi18=(p_of_prime-<span class="number">1</span>)*(q18-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">        d1=gmpy2.invert(e[<span class="number">1</span>],phi1)<span class="comment">#计算私钥</span></span><br><span class="line">        d18=gmpy2.invert(e[<span class="number">18</span>],phi18)<span class="comment">#计算私钥</span></span><br><span class="line">        m1=<span class="built_in">pow</span>(c[<span class="number">1</span>],d1,n[<span class="number">1</span>])<span class="comment">#解密</span></span><br><span class="line">        m18=<span class="built_in">pow</span>(c[<span class="number">18</span>],d18,n[<span class="number">18</span>])<span class="comment">#解密</span></span><br><span class="line">        m1=<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m18=<span class="built_in">hex</span>(m18)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m1=binascii.unhexlify(m1)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        m18=binascii.unhexlify(m18)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame1&#x27;</span>]=m1</span><br><span class="line">        sloved[<span class="string">&#x27;Frame18&#x27;</span>]=m18</span><br></pre></td></tr></table></figure>

<blockquote>
<p>‘Frame1’: b’. Imagin’, ‘Frame18’: b’m A to B’</p>
</blockquote>
<h3 id="低指数广播攻击"><a href="#低指数广播攻击" class="headerlink" title="低指数广播攻击"></a>低指数广播攻击</h3><p>Frame3、Frame8、Frame12、Frame16、Frame20采用该种攻击方法</p>
<p>低加密指数广播攻击适合于$\mathrm{n}$很大,$e$很小的情况, 其适用的情况是如$\mathrm{n}$下的，当一条消息$m$发送给不同的接收者时，每个接收者的 $n$ 都不同，但是加密公钥都是相同的，我们假设公钥为3那么就有<br>$$<br>\left{\begin{array}{l}<br>C_1&#x3D;m^3 \bmod n_1 \<br>C_2&#x3D;m^3 \bmod n_2 \<br>C_3&#x3D;m^3 \bmod n_3<br>\end{array}\right.<br>$$<br>由中国剩余定理知道,我们是可以将 $m^3$ 算出来的，那么对其开立方就将明文给求出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#中国剩余定理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder_theorem</span>(<span class="params">backup</span>):</span><br><span class="line">        <span class="comment">#计算N的乘积</span></span><br><span class="line">        N=<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> a,n <span class="keyword">in</span> backup:</span><br><span class="line">                N*=n</span><br><span class="line">        <span class="comment">#计算Ni</span></span><br><span class="line">        Ni=[]</span><br><span class="line">        <span class="keyword">for</span> a,n <span class="keyword">in</span> backup:</span><br><span class="line">                Ni.append(N//n)</span><br><span class="line">        <span class="comment">#计算Ni的模逆元</span></span><br><span class="line">        Ni_inverse=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(Ni)):</span><br><span class="line">                Ni_inverse.append(gmpy2.invert(Ni[i],backup[i][<span class="number">1</span>]))</span><br><span class="line">        <span class="comment">#计算x</span></span><br><span class="line">        x=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(Ni)):</span><br><span class="line">                x+=backup[i][<span class="number">0</span>]*Ni[i]*Ni_inverse[i]</span><br><span class="line">        x=x%N</span><br><span class="line">        <span class="keyword">return</span> x,N</span><br><span class="line"></span><br><span class="line"><span class="comment">#低指数3</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_exponent_attack3</span>():</span><br><span class="line">        frame_range=[<span class="number">7</span>,<span class="number">11</span>,<span class="number">15</span>]</span><br><span class="line">        backup=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                backup.append([c[i],n[i]])</span><br><span class="line">        x,N=chinese_remainder_theorem(backup)</span><br><span class="line">        <span class="comment">#开三次方根</span></span><br><span class="line">        m=gmpy2.iroot(x,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">        m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame7&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame11&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame15&#x27;</span>]=m</span><br><span class="line"><span class="comment">#低指数5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_exponent_attack5</span>():</span><br><span class="line">        frame_range=[<span class="number">3</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">16</span>,<span class="number">20</span>]</span><br><span class="line">        backup=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                backup.append([c[i],n[i]])</span><br><span class="line">        x,N=chinese_remainder_theorem(backup)</span><br><span class="line">        <span class="comment">#开五次方根</span></span><br><span class="line">        m=gmpy2.iroot(x,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line">        m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame3&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame8&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame12&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame16&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame20&#x27;</span>]=m</span><br></pre></td></tr></table></figure>



<blockquote>
<p>‘Frame7’: b’\xb8\xbc\xa2S)s\xcd\xd2’, ‘Frame11’: b’\xb8\xbc\xa2S)s\xcd\xd2’, ‘Frame15’: b’\xb8\xbc\xa2S)s\xcd\xd2’, ‘Frame3’: b’t is a f’, ‘Frame8’: b’t is a f’, ‘Frame12’: b’t is a f’, ‘Frame16’: b’t is a f’, ‘Frame20’: b’t is a f’</p>
</blockquote>
<p>可以看到Frame7，Frame11，Frame15采用低加密指数广播攻击出来是乱码，说明该种方法不正确</p>
<p>Frame3、Frame8、Frame12、Frame16、Frame20可以采用该种攻击方法</p>
<h3 id="Coppersmith广播攻击"><a href="#Coppersmith广播攻击" class="headerlink" title="Coppersmith广播攻击"></a>Coppersmith广播攻击</h3><p>Coppersmith 是干了这么一件事: 今有一个 $e$ 阶的多项式 $f$, 那么可以:</p>
<ul>
<li><p>在模 $n$ 意义下，快速求出 $n^{1 &#x2F; e}$ 以内的根</p>
</li>
<li><p>给定 $\beta$ ，快速求出模某个 $b$ 意义下较小的根，其中 $b \geq n^\beta$ ，是 $n$ 的因数。</p>
</li>
</ul>
<h3 id="Pollard-p-1分解法"><a href="#Pollard-p-1分解法" class="headerlink" title="Pollard p-1分解法"></a>Pollard p-1分解法</h3><p>Frame2、Frame6、Frame19均采用该种攻击方法</p>
<p>Pollard p-1分解法是一种用于分解大质数的算法，它是Pollard rho算法的一种变体。它的基本思想是利用费马小定理来找到大质数的一个小因子。</p>
<p>如果 $p$ 与 $q$ 都不超过 $10^{20}$ 次方, 若其中一个 $(p-1)$ 或 $(q-1)$ 的因子都很小的时候（适用于p-1或q-1能够被小素数整除的情况,在这里为了方便说明我们假设为 $(p-1))$ ,可以如下操作:<br>选取一个整数 $k$, 使其满足 $(p-1) \mid k!$，由费马小定理知道, $a$ 与 $p$ 互素 的时候有<br>$$<br>a^{p-1}&#x3D;1 \bmod p<br>$$<br>所以 $a^{k !}&#x3D;1 \bmod p \quad, \quad$即 $\mathrm{p} \mid\left(a^{k !}-1\right)$ 。 那么对于 $\mathrm{n}$ 与 $\left(a^{k !}-1\right)$ 必有公因数为 $\mathrm{p}$, 这样就可以把 $\mathrm{n}$ 分解出来了。 但是对于 $k$ 的选取还是有要求的，太小了 $(p-1) \mid k !$不会成立，太大了花费时间会很多。</p>
<blockquote>
<ol>
<li>首先选取一个合适的整数a和一个正整数B；</li>
<li>选择一个整数k，使得k满足2&lt;&#x3D;k&lt;&#x3D;B；</li>
<li>计算$a^k ~ mod ~ n$，然后将其与n计算最大公因数，记为d；</li>
<li>如果d是n的因子，则输出d；否则，将d作为下一次迭代的起点，重复执行第3步和第4步，直到找到一个因子或者达到最大迭代次数为止。</li>
</ol>
<p>在实际使用中，可以选择多个不同的a值和不同的B值，然后分别运行p-1分解法，取所有得到的因子的最大公因数作为最终的结果。</p>
<p>需要注意的是，p-1分解法的效率取决于选取的参数a和B的大小。如果a过小或B过大，算法可能无法找到因子；如果a过大或B过小，算法可能会陷入循环而无法得到结果。因此，在实际应用中需要进行合理的参数选择。</p>
<p>Get $\mathrm{n}$, an odd integer to be factored.</p>
<p>Let $\mathrm{a}&#x3D;2$ and $\mathrm{i}&#x3D;2$.</p>
<p>Compute $a&#x3D;a^i \bmod n$.</p>
<p>Compute $\mathrm{d}&#x3D;\operatorname{gcd}(\mathrm{a}-1, \mathrm{n})$.</p>
<p>If $1&lt;\mathrm{d}&lt;\mathrm{n}$, then output $\mathrm{d}$ as a factor of $\mathrm{n}$.</p>
<p>If $\mathrm{d}&#x3D;1$, then $\mathrm{i}&#x3D;\mathrm{i}+1$, and go to step 3.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Pollard&#x27;s p-1算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_p_1</span>(<span class="params">n</span>):</span><br><span class="line">        b=<span class="number">2</span>**<span class="number">20</span></span><br><span class="line">        a=<span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,b+<span class="number">1</span>):</span><br><span class="line">                a=gmpy2.powmod(a,i,n)</span><br><span class="line">                d=gmpy2.gcd(a-<span class="number">1</span>,n)</span><br><span class="line">                <span class="keyword">if</span> d!=<span class="number">1</span> <span class="keyword">and</span> d!=n:</span><br><span class="line">                        q=n//d</span><br><span class="line">                        n=q*d</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_data</span>(<span class="params">n</span>):</span><br><span class="line">        frame_range=[<span class="number">2</span>,<span class="number">6</span>,<span class="number">19</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                temp_n=n[i]</span><br><span class="line">                temp_c=c[i]</span><br><span class="line">                temp_e=e[i]</span><br><span class="line">                p=pollard_p_1(temp_n)</span><br><span class="line">                q=temp_n//p</span><br><span class="line">                phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">                d=gmpy2.invert(temp_e,phi)</span><br><span class="line">                m=<span class="built_in">pow</span>(temp_c,d,temp_n)</span><br><span class="line">                m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">                m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m</span><br></pre></td></tr></table></figure>



<blockquote>
<p>‘Frame2’: b’ That is’, ‘Frame6’: b’ “Logic ‘, ‘Frame19’: b’instein.’</p>
</blockquote>
<h3 id="费马分解法"><a href="#费马分解法" class="headerlink" title="费马分解法"></a>费马分解法</h3><p>如果 $p$ 和 $q$ 相差不大的话我们可以通过费马分解把 $p$ 和 $q$ 求出来, 原理如 下<br>$$<br>\mathrm{n}&#x3D;\mathrm{p} * \mathrm{q}&#x3D;\frac{1}{4}(p+q)^2-\frac{1}{4}(p-q)^2<br>$$<br>由于 $\mathrm{p}$ 与 $\mathrm{q}$ 相差不大, 所以 $\mathrm{p}-\mathrm{q}$ 相对于 $\mathrm{n}$ 和 $(p+q)^2$ 来说可以忽略不计, 所以有～<br>$$<br>2 \sqrt{\mathrm{n}} \approx \mathrm{p}+\mathrm{q}<br>$$<br>也就是说通过不断尝试就可以把 $\mathrm{p}$ 和 $\mathrm{q}$ 给计算出来了</p>
<p>p、q比较接近时，可以使用这种攻击方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 费马分解</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factorization</span>(<span class="params">n</span>):</span><br><span class="line">        a=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">        <span class="built_in">max</span>=<span class="number">200000</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">max</span>):</span><br><span class="line">                b2=a*a-n</span><br><span class="line">                b=gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">                        p=a-b</span><br><span class="line">                        q=a+b</span><br><span class="line">                        <span class="keyword">return</span> p,q</span><br><span class="line">                a+=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_data</span>():</span><br><span class="line">        frame_range=[<span class="number">10</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                p,q=fermat_factorization(n[i])</span><br><span class="line">                phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">                d=gmpy2.invert(e[i],phi)<span class="comment">#计算私钥</span></span><br><span class="line">                m=<span class="built_in">pow</span>(c[i],d,n[i])<span class="comment">#解密</span></span><br><span class="line">                m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">                m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>经检验,Frame10可以采用该种攻击方法</p>
<blockquote>
<p>‘Frame10’: b’will get’</p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><table>
<thead>
<tr>
<th>帧号</th>
<th>value</th>
<th>solution</th>
</tr>
</thead>
<tbody><tr>
<td>Frame0</td>
<td>My secre</td>
<td>公共模数攻击</td>
</tr>
<tr>
<td>Frame1</td>
<td>. Imagin</td>
<td>公因数碰撞攻击</td>
</tr>
<tr>
<td>Frame2</td>
<td>That is</td>
<td>Pollard rho-p-1分解法</td>
</tr>
<tr>
<td>Frame3</td>
<td>t is a f</td>
<td>低指数广播攻击</td>
</tr>
<tr>
<td>Frame4</td>
<td>My secre</td>
<td>公共模数攻击</td>
</tr>
<tr>
<td>Frame5</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Frame6</td>
<td>“Logic</td>
<td>Pollard rho-p-1分解法</td>
</tr>
<tr>
<td>Frame7</td>
<td>\xb8\xbc\xa2S)s\xcd\xd2</td>
<td></td>
</tr>
<tr>
<td>Frame8</td>
<td>t is a f</td>
<td>低指数广播攻击</td>
</tr>
<tr>
<td>Frame9</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Frame10</td>
<td>will get</td>
<td>费马分解法</td>
</tr>
<tr>
<td>Frame11</td>
<td>\xb8\xbc\xa2S)s\xcd\xd2</td>
<td></td>
</tr>
<tr>
<td>Frame12</td>
<td>t is a f</td>
<td>低指数广播攻击</td>
</tr>
<tr>
<td>Frame13</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Frame14</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Frame15</td>
<td>\xb8\xbc\xa2S)s\xcd\xd2</td>
<td></td>
</tr>
<tr>
<td>Frame16</td>
<td>t is a f</td>
<td>低指数广播攻击</td>
</tr>
<tr>
<td>Frame17</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Frame18</td>
<td>m A to B</td>
<td>公因数碰撞攻击</td>
</tr>
<tr>
<td>Frame19</td>
<td>instein.</td>
<td>Pollard rho-p-1分解法</td>
</tr>
<tr>
<td>Frame20</td>
<td>t is a f</td>
<td>低指数广播攻击</td>
</tr>
</tbody></table>
<p>整理一下My secret is a f__instein. That is “Logic will get__m A to B. Imagin__</p>
<p>根据搜索结果可以补全后面的saying的内容,根据语义也可以填充前面的内容</p>
<p> My secret is a famous saying of Albert Einstein. That is “Logic will get you from A to B. Imagination will take you everywhere.“</p>
<p><img src="/./RSAattack.assets/image-20230908144419298.png" alt="image-20230908144419298"></p>
<p>​	<img src="/./RSAattack.assets/image-20230908144427957.png" alt="image-20230908144427957">	</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ol>
<li><p>[2016 全国高校密码数学挑战赛-赛题三] <a target="_blank" rel="noopener" href="https://www.tr0y.wang/2017/10/31/RSA2016/">https://www.tr0y.wang/2017/10/31/RSA2016/</a></p>
</li>
<li><p>[现代密码学大作业] <a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_63571390/article/details/122375466?spm=1001.2014.3001.5501">https://blog.csdn.net/m0_63571390/article/details/122375466?spm=1001.2014.3001.5501</a></p>
</li>
<li><p>[关于RSA的几种攻击手段] <a target="_blank" rel="noopener" href="https://blog.csdn.net/pigeon_1/article/details/114371456">https://blog.csdn.net/pigeon_1/article/details/114371456</a></p>
</li>
<li><p>[Twenty Years of Attacks on the RSA Cryptosystem] <a target="_blank" rel="noopener" href="https://www.ams.org/notices/199902/boneh.pdf">https://www.ams.org/notices/199902/boneh.pdf</a></p>
</li>
<li><p>[On using Pollard’s p-1 Algorithm to Factor RPrime RSA Modulus] <a target="_blank" rel="noopener" href="https://www.scitepress.org/Papers/2018/100836/100836.pdf">https://www.scitepress.org/Papers/2018/100836/100836.pdf</a></p>
</li>
</ol>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">n=[]<span class="comment">#模数集合</span></span><br><span class="line">e=[]<span class="comment">#公钥指数集合</span></span><br><span class="line">c=[]<span class="comment">#密文集合</span></span><br><span class="line">m=&#123;<span class="built_in">zip</span>([<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>)],<span class="string">&#x27;&#x27;</span>)&#125;</span><br><span class="line"><span class="comment"># Path: code\main.py</span></span><br><span class="line">sloved=&#123;&#125;<span class="comment">#已解密的密文集合</span></span><br><span class="line">filename=[<span class="string">&#x27;data\Frame&#x27;</span>+<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>)]<span class="comment">#文件名集合</span></span><br><span class="line"><span class="comment"># print(filename)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        f=<span class="built_in">open</span>(filename[i],<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        data=f.read()</span><br><span class="line">        <span class="comment">#str-&gt;hex-&gt;int</span></span><br><span class="line">        n.append(<span class="built_in">int</span>(data[:<span class="number">256</span>],<span class="number">16</span>))</span><br><span class="line">        e.append(<span class="built_in">int</span>(data[<span class="number">256</span>:<span class="number">512</span>],<span class="number">16</span>))</span><br><span class="line">        c.append(<span class="built_in">int</span>(data[<span class="number">512</span>:],<span class="number">16</span>))</span><br><span class="line"><span class="comment">#输出e的值</span></span><br><span class="line"><span class="comment"># for i in range(0,21):</span></span><br><span class="line"><span class="comment">#     print(&#x27;e[&#x27;+str(i)+&#x27;]=&#x27;+str(e[i]))</span></span><br><span class="line"><span class="comment"># #输出n的值</span></span><br><span class="line"><span class="comment"># for i in range(0,21):</span></span><br><span class="line"><span class="comment">#     print(&#x27;n[&#x27;+str(i)+&#x27;]=&#x27;+str(n[i]))</span></span><br><span class="line"><span class="comment"># #输出c的</span></span><br><span class="line"><span class="comment"># for i in range(0,21):</span></span><br><span class="line"><span class="comment">#     print(&#x27;c[&#x27;+str(i)+&#x27;]=&#x27;+str(c[i]))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历所有模数,找到模数相同的加密密文</span></span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;n[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]==&#x27;</span>+<span class="string">&#x27;n[&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历寻找任意两个模数N的公因子，如果得到不为1的公因子则可以成功分解这两个模数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">            <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rem=math.gcd(n[i],n[j])</span><br><span class="line">                <span class="keyword">if</span> rem!=<span class="number">1</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;gcd(n[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;],n[&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;])=&#x27;</span>+<span class="built_in">str</span>(rem))</span><br><span class="line"></span><br><span class="line"><span class="comment">#公共模数攻击</span></span><br><span class="line"><span class="comment">#扩展欧几里得算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a,b</span>):</span><br><span class="line">        <span class="keyword">if</span> b==<span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                x,y,r=exgcd(b,a%b)</span><br><span class="line">                x,y=y,(x-(a//b)*y)</span><br><span class="line">                <span class="keyword">return</span> x,y,r</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">same_mod_attack</span>(<span class="params">n,e1,e2,c1,c2</span>):</span><br><span class="line">    x,y,r=exgcd(e1,e2)</span><br><span class="line">    <span class="comment">#求模逆元</span></span><br><span class="line">    <span class="keyword">if</span> x&lt;<span class="number">0</span>:</span><br><span class="line">        x=-x;</span><br><span class="line">        c1=gmpy2.invert(c1,n)</span><br><span class="line">    <span class="keyword">elif</span> y&lt;<span class="number">0</span>:</span><br><span class="line">        y=-y;</span><br><span class="line">        c2=gmpy2.invert(c2,n) </span><br><span class="line">    <span class="comment">#求解明文</span></span><br><span class="line">    m=<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n</span><br><span class="line">    <span class="comment">#将明文转换为hex</span></span><br><span class="line">    m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">    <span class="comment">#将hex转换为str</span></span><br><span class="line">    m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#公因数碰撞攻击</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">same_factor_attack</span>():</span><br><span class="line">        p_of_prime=gmpy2.gcd(n[<span class="number">1</span>],n[<span class="number">18</span>])</span><br><span class="line">        q1=n[<span class="number">1</span>]//p_of_prime</span><br><span class="line">        q18=n[<span class="number">18</span>]//p_of_prime</span><br><span class="line">        phi1=(p_of_prime-<span class="number">1</span>)*(q1-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">        phi18=(p_of_prime-<span class="number">1</span>)*(q18-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">        d1=gmpy2.invert(e[<span class="number">1</span>],phi1)<span class="comment">#计算私钥</span></span><br><span class="line">        d18=gmpy2.invert(e[<span class="number">18</span>],phi18)<span class="comment">#计算私钥</span></span><br><span class="line">        m1=<span class="built_in">pow</span>(c[<span class="number">1</span>],d1,n[<span class="number">1</span>])<span class="comment">#解密</span></span><br><span class="line">        m18=<span class="built_in">pow</span>(c[<span class="number">18</span>],d18,n[<span class="number">18</span>])<span class="comment">#解密</span></span><br><span class="line">        m1=<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m18=<span class="built_in">hex</span>(m18)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m1=binascii.unhexlify(m1)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        m18=binascii.unhexlify(m18)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame1&#x27;</span>]=m1</span><br><span class="line">        sloved[<span class="string">&#x27;Frame18&#x27;</span>]=m18</span><br><span class="line"><span class="comment">#中国剩余定理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder_theorem</span>(<span class="params">backup</span>):</span><br><span class="line">        <span class="comment">#计算N的乘积</span></span><br><span class="line">        N=<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> a,n <span class="keyword">in</span> backup:</span><br><span class="line">                N*=n</span><br><span class="line">        <span class="comment">#计算Ni</span></span><br><span class="line">        Ni=[]</span><br><span class="line">        <span class="keyword">for</span> a,n <span class="keyword">in</span> backup:</span><br><span class="line">                Ni.append(N//n)</span><br><span class="line">        <span class="comment">#计算Ni的模逆元</span></span><br><span class="line">        Ni_inverse=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(Ni)):</span><br><span class="line">                Ni_inverse.append(gmpy2.invert(Ni[i],backup[i][<span class="number">1</span>]))</span><br><span class="line">        <span class="comment">#计算x</span></span><br><span class="line">        x=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(Ni)):</span><br><span class="line">                x+=backup[i][<span class="number">0</span>]*Ni[i]*Ni_inverse[i]</span><br><span class="line">        x=x%N</span><br><span class="line">        <span class="keyword">return</span> x,N</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#低指数3</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_exponent_attack3</span>():</span><br><span class="line">        frame_range=[<span class="number">7</span>,<span class="number">11</span>,<span class="number">15</span>]</span><br><span class="line">        backup=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                backup.append([c[i],n[i]])</span><br><span class="line">        x,N=chinese_remainder_theorem(backup)</span><br><span class="line">        <span class="comment">#开三次方根</span></span><br><span class="line">        m=gmpy2.iroot(x,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">        m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame7&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame11&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame15&#x27;</span>]=m</span><br><span class="line"></span><br><span class="line"><span class="comment">#低指数5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_exponent_attack5</span>():</span><br><span class="line">        frame_range=[<span class="number">3</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">16</span>,<span class="number">20</span>]</span><br><span class="line">        backup=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                backup.append([c[i],n[i]])</span><br><span class="line">        x,N=chinese_remainder_theorem(backup)</span><br><span class="line">        <span class="comment">#开五次方根</span></span><br><span class="line">        m=gmpy2.iroot(x,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line">        m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">        m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">        sloved[<span class="string">&#x27;Frame3&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame8&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame12&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame16&#x27;</span>]=m</span><br><span class="line">        sloved[<span class="string">&#x27;Frame20&#x27;</span>]=m</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 费马分解</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factorization</span>(<span class="params">n</span>):</span><br><span class="line">        a=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">        <span class="built_in">max</span>=<span class="number">200000</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">max</span>):</span><br><span class="line">                b2=a*a-n</span><br><span class="line">                b=gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">                        p=a-b</span><br><span class="line">                        q=a+b</span><br><span class="line">                        <span class="keyword">return</span> p,q</span><br><span class="line">                a+=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_data</span>():</span><br><span class="line">        frame_range=[<span class="number">10</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                p,q=fermat_factorization(n[i])</span><br><span class="line">                phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)<span class="comment">#计算欧拉函数</span></span><br><span class="line">                d=gmpy2.invert(e[i],phi)<span class="comment">#计算私钥</span></span><br><span class="line">                m=<span class="built_in">pow</span>(c[i],d,n[i])<span class="comment">#解密</span></span><br><span class="line">                m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">                m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="comment">#Pollard&#x27;s p-1算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_p_1</span>(<span class="params">n</span>):</span><br><span class="line">        b=<span class="number">2</span>**<span class="number">20</span></span><br><span class="line">        a=<span class="number">2</span></span><br><span class="line">        <span class="comment"># while True:</span></span><br><span class="line">        <span class="comment">#         a=gmpy2.powmod(a,b,n)</span></span><br><span class="line">        <span class="comment">#         d=gmpy2.gcd(a-1,n)</span></span><br><span class="line">        <span class="comment">#         if d!=1 and d!=n:</span></span><br><span class="line">        <span class="comment">#                 return d</span></span><br><span class="line">        <span class="comment">#         a+=1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,b+<span class="number">1</span>):</span><br><span class="line">                a=gmpy2.powmod(a,i,n)</span><br><span class="line">                d=gmpy2.gcd(a-<span class="number">1</span>,n)</span><br><span class="line">                <span class="keyword">if</span> d!=<span class="number">1</span> <span class="keyword">and</span> d!=n:</span><br><span class="line">                        q=n//d</span><br><span class="line">                        n=q*d</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_data</span>(<span class="params">n</span>):</span><br><span class="line">        frame_range=[<span class="number">2</span>,<span class="number">6</span>,<span class="number">19</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> frame_range:</span><br><span class="line">                temp_n=n[i]</span><br><span class="line">                temp_c=c[i]</span><br><span class="line">                temp_e=e[i]</span><br><span class="line">                p=pollard_p_1(temp_n)</span><br><span class="line">                q=temp_n//p</span><br><span class="line">                phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">                d=gmpy2.invert(temp_e,phi)</span><br><span class="line">                m=<span class="built_in">pow</span>(temp_c,d,temp_n)</span><br><span class="line">                m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]<span class="comment">#去掉0x</span></span><br><span class="line">                m=binascii.unhexlify(m)[-<span class="number">8</span>:]<span class="comment">#hex-&gt;str</span></span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment">#公共模数攻击</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">            <span class="keyword">if</span> n[i]==n[j]:</span><br><span class="line">                m2=same_mod_attack(n[i],e[i],e[j],c[i],c[j])</span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)]=m2</span><br><span class="line">                sloved[<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(j)]=m2</span><br><span class="line">     <span class="comment">#公因数碰撞攻击</span></span><br><span class="line">    same_factor_attack()</span><br><span class="line">    <span class="built_in">print</span>(sloved)</span><br><span class="line">     <span class="comment">#低指数攻击</span></span><br><span class="line">    low_exponent_attack3()</span><br><span class="line">    low_exponent_attack5()</span><br><span class="line">    <span class="built_in">print</span>(sloved)</span><br><span class="line">    <span class="comment">#费马分解</span></span><br><span class="line">    fermat_data()</span><br><span class="line">    <span class="built_in">print</span>(sloved)</span><br><span class="line">    <span class="comment">#Pollard&#x27;s p-1算法</span></span><br><span class="line">    pollard_data(n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(sloved)</span><br><span class="line">    <span class="comment">#输出将地点按照帧数排序</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">            Frame_name=<span class="string">&#x27;Frame&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">            <span class="keyword">if</span> Frame_name <span class="keyword">in</span> sloved:</span><br><span class="line">                    <span class="built_in">print</span>(Frame_name+<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(sloved[Frame_name])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(Frame_name+<span class="string">&#x27;:Not sloved&#x27;</span>)</span><br><span class="line">                        </span><br></pre></td></tr></table></figure>


    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Asiv, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/Crypto/" class="tag">#Crypto</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2022/11/28/PE_DLL/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">通过修改 PE 装载 DLL 实验</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2022/10/31/Week6%20quiz/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Week 6 - Programming Assignment</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/NiceAsiv" class="item">GitHub</a>
                
                <a href="asiwuhe@hotmail.com" class="item">mail</a>
                
                <a href="/about" class="item">About</a>
                
            </div>
            
        </div>
        <span>&copy; 2023 Asiv<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>